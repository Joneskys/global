<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NSE Pace Dashboard (LIVE)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{margin:0;background:#0f172a;color:#e5e7eb;font-family:Arial}
.container{max-width:1200px;margin:auto;padding:20px}
h1{color:#38bdf8}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:15px}
.card{background:#020617;border-radius:10px;padding:15px}
.fast{color:#22c55e;font-weight:bold}
.slow{color:#f87171;font-weight:bold}
ul{padding-left:18px}
small{color:#94a3b8}
</style>
</head>

<body>
<div class="container">
<h1>‚ö° NSE Pace Dashboard (LIVE)</h1>
<small>5-min candles ‚Ä¢ Yahoo Finance Live</small>

<div class="grid">
  <div class="card">
    <h3>‚ö° Pace Monitor (SBIN)</h3>
    <div id="paceBox">Loading‚Ä¶</div>
  </div>

  <div class="card">
    <h3>üìä Top FAST Stocks</h3>
    <ul id="fastList"></ul>
  </div>
</div>
</div>

<script>
/* ============ TELEGRAM CONFIG ============ */
const TELEGRAM_BOT_TOKEN = "PASTE_BOT_TOKEN";
const TELEGRAM_CHAT_ID  = "PASTE_CHAT_ID";

/* ============ TELEGRAM FUNCTION ============ */
function sendTelegram(msg){
  fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({chat_id:TELEGRAM_CHAT_ID,text:msg})
  });
}

/* ============ PACE ENGINE ============ */
function calcROC(c,p=5){
  if(c.length<p+1) return 0;
  return ((c.at(-1)-c.at(-p-1))/c.at(-p-1))*100;
}
function calcATR(h,l,c,p=14){
  if(c.length<p+1) return 0;
  let tr=0;
  for(let i=c.length-p;i<c.length;i++){
    tr+=Math.max(
      h[i]-l[i],
      Math.abs(h[i]-c[i-1]),
      Math.abs(l[i]-c[i-1])
    );
  }
  return tr/p;
}
function calcADX(h,l,p=14){
  if(h.length<p) return 0;
  let s=0;
  for(let i=h.length-p;i<h.length;i++)
    s+=Math.abs(h[i]-l[i]);
  return s/p;
}
function volumePace(v,p=10){
  if(v.length<p) return 0;
  let avg=v.slice(-p).reduce((a,b)=>a+b)/p;
  return (v.at(-1)/avg)*100;
}
function paceResult(d){
  let roc=calcROC(d.close);
  let atr=calcATR(d.high,d.low,d.close);
  let adx=calcADX(d.high,d.low);
  let vp=volumePace(d.volume);
  let score=0;
  if(roc>0.7) score++;
  if(adx>25) score++;
  if(vp>150) score++;
  if(atr>d.avgATR) score++;
  return {roc,adx,vp,fast:score>=3};
}

/* ============ YAHOO LIVE FETCH ============ */
async function fetchYahoo(symbol, interval="5m"){
  const url=`https://query1.finance.yahoo.com/v8/finance/chart/${symbol}?interval=${interval}&range=1d`;
  const r=await fetch(url);
  const j=await r.json();
  const q=j.chart.result[0];
  return {
    close:q.indicators.quote[0].close.filter(x=>x),
    high:q.indicators.quote[0].high.filter(x=>x),
    low:q.indicators.quote[0].low.filter(x=>x),
    volume:q.indicators.quote[0].volume.filter(x=>x),
    avgATR: (Math.max(...q.indicators.quote[0].high.slice(-20)) -
             Math.min(...q.indicators.quote[0].low.slice(-20))) / 2
  };
}

/* ============ SYMBOLS (Yahoo) ============ */
const symbols={
  "SBIN":"SBIN.NS",
  "RELIANCE":"RELIANCE.NS",
  "BANKNIFTY":"^NSEBANK"
};

/* ============ MAIN LOGIC ============ */
async function run(){
  let fastHTML="";
  for(let s in symbols){
    try{
      let data=await fetchYahoo(symbols[s]);
      let p=paceResult(data);

      if(s==="SBIN"){
        document.getElementById("paceBox").innerHTML=`
        ROC: ${p.roc.toFixed(2)}%<br>
        ADX: ${p.adx.toFixed(1)}<br>
        VOL PACE: ${p.vp.toFixed(0)}%<br>
        <b class="${p.fast?'fast':'slow'}">
        ${p.fast?'‚ö° FAST':'üê¢ SLOW'}
        </b>`;
      }

      if(p.fast){
        fastHTML+=`<li>‚ö° ${s} | ROC ${p.roc.toFixed(1)}%</li>`;

        if(p.roc>0.7 && p.adx>25 && p.vp>150){
          sendTelegram(
`‚ö° STOCK PACE ALERT
${s}
ROC: ${p.roc.toFixed(2)}%
ADX: ${p.adx.toFixed(1)}
VOL: ${p.vp.toFixed(0)}%`
          );
        }
      }
    }catch(e){
      console.log("Error:",s,e);
    }
  }
  document.getElementById("fastList").innerHTML=
    fastHTML || "<li>No FAST stocks</li>";
}

run();
</script>
</body>
</html>
