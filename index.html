<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Global Market Dashboard</title>

<style>
body{
  background:#020617;
  color:#e5e7eb;
  font-family:system-ui;
  display:flex;
  justify-content:center;
  padding:30px;
}
.card{
  background:#0f172a;
  border:1px solid #1f2937;
  border-radius:20px;
  padding:20px;
  width:520px;
}
.row{
  display:flex;
  justify-content:space-between;
  padding:10px;
  border-radius:10px;
}
small{color:#94a3b8}
input,button{
  background:#020617;
  border:1px solid #1f2937;
  color:#fff;
  padding:8px;
  border-radius:10px;
}
</style>
</head>
<body>

<div class="card">
<h2>ğŸŒ Global Market Dashboard</h2>

<div class="row">ğŸ’µ USD â†’ INR <span id="usd">Loading...</span></div>
<div class="row">ğŸŸ¨ Gold <span id="gold">Loading...</span></div>
<div class="row">ğŸª™ Silver <span id="silver">Loading...</span></div>
<div class="row">ğŸŸ« Copper <span id="copper">Loading...</span></div>
<div class="row">ğŸ›¢ Crude Oil <span id="crude">Loading...</span></div>

<hr style="border-color:#1f2937">

<input id="alertInput" placeholder="Gold alert â‚¹/gram">
<button onclick="setAlert()">ğŸ”” Set Gold Alert</button>
<div id="alertStatus"><small>No alert set</small></div>

<p><small>Auto refresh every 60 seconds</small></p>
</div>

<script>
const WORKER = "https://red-tooth-e4f7.lovelyideas-in.workers.dev?symbol=";

let alertTarget = null;

async function getPrice(symbol){
  const r = await fetch(WORKER + symbol);
  const j = await r.json();
  return j.chart.result[0].meta.regularMarketPrice;
}

async function refresh(){
  try{
    const usd = await getPrice("USDINR=X");
    const gold = await getPrice("XAUUSD=X");
    const silver = await getPrice("XAGUSD=X");
    const copper = await getPrice("HG=F");   // per pound
    const crude = await getPrice("CL=F");    // per barrel

    // conversions
    const goldInr = (gold * usd) / 31.1035;              // â‚¹/gram
    const silverInr = (silver * usd) * 32.1507;          // â‚¹/kg
    const copperInr = (copper * usd) * 2.20462;          // â‚¹/kg
    const crudeInr = (crude * usd) / 159;                // â‚¹/liter

    usd.innerHTML = `â‚¹${usd.toFixed(2)}`;
    goldSpan.innerHTML = `$${gold.toFixed(2)}/oz â†’ â‚¹${goldInr.toFixed(2)}/g`;
    silverSpan.innerHTML = `$${silver.toFixed(2)}/oz â†’ â‚¹${silverInr.toFixed(0)}/kg`;
    copperSpan.innerHTML = `$${copper.toFixed(2)}/lb â†’ â‚¹${copperInr.toFixed(0)}/kg`;
    crudeSpan.innerHTML = `$${crude.toFixed(2)}/bbl â†’ â‚¹${crudeInr.toFixed(2)}/L`;

    // alert
    if(alertTarget && goldInr >= alertTarget){
      alert("ğŸ”” Gold crossed â‚¹" + goldInr.toFixed(2));
      alertTarget = null;
      alertStatus.innerHTML = "<small>No alert set</small>";
    }

  }catch(e){
    console.error(e);
  }
}

function setAlert(){
  alertTarget = parseFloat(alertInput.value);
  alertStatus.innerHTML = "<small>Alert set at â‚¹" + alertTarget + "</small>";
}

const goldSpan = document.getElementById("gold");
const silverSpan = document.getElementById("silver");
const copperSpan = document.getElementById("copper");
const crudeSpan = document.getElementById("crude");

refresh();
setInterval(refresh,60000);
</script>

</body>
</html>
