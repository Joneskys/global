<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Global Market Dashboard</title>

<style>
body{
  background:#020617;
  color:#e5e7eb;
  font-family:system-ui;
  display:flex;
  justify-content:center;
  padding:30px;
}
.card{
  background:#0f172a;
  border:1px solid #1f2937;
  border-radius:20px;
  padding:20px;
  width:560px;
}
.row{
  display:flex;
  justify-content:space-between;
  padding:10px;
  border-radius:10px;
}
small{color:#94a3b8}
input,button{
  background:#020617;
  border:1px solid #1f2937;
  color:#fff;
  padding:8px;
  border-radius:10px;
}
</style>
</head>
<body>

<div class="card">
<h2>ğŸŒ Global Market Dashboard</h2>

<div class="row">ğŸ’µ USD â†’ INR <span id="usd">...</span></div>
<div class="row">ğŸŸ¨ Gold <span id="gold">...</span></div>
<div class="row">ğŸª™ Silver <span id="silver">...</span></div>
<div class="row">ğŸŸ« Copper <span id="copper">...</span></div>
<div class="row">ğŸ›¢ Crude Oil <span id="crude">...</span></div>

<hr style="border-color:#1f2937">

<input id="alertInput" placeholder="Gold alert â‚¹/gram">
<button onclick="setAlert()">ğŸ”” Set Gold Alert</button>
<div id="alertStatus"><small>No alert set</small></div>

<p><small>Auto refresh every 60 seconds</small></p>
</div>

<script>
const WORKER = "https://red-tooth-e4f7.lovelyideas-in.workers.dev?url=";
let alertTarget = null;

async function get(sym){
  let r = await fetch(WORKER + encodeURIComponent(
    `https://query1.finance.yahoo.com/v8/finance/chart/${sym}?interval=1m&range=1d`
  ));
  let j = await r.json();
  return j.chart.result[0].meta.regularMarketPrice;
}

async function refresh(){
  try{
    let usd = await get("USDINR=X");
    let gold = await get("XAUUSD=X");
    let silver = await get("XAGUSD=X");
    let copper = await get("HG=F");      // per lb
    let crude = await get("CL=F");       // per barrel

    let goldInr = (gold*usd)/31.1035;
    let silverInr = (silver*usd)*32.1507;
    let copperInr = (copper*usd)*2.20462;
    let crudeInr = (crude*usd)/159;

    usdSpan.textContent = `â‚¹${usd.toFixed(2)}`;
    goldSpan.textContent = `$${gold.toFixed(2)}/oz â†’ â‚¹${goldInr.toFixed(2)}/g`;
    silverSpan.textContent = `$${silver.toFixed(2)}/oz â†’ â‚¹${silverInr.toFixed(0)}/kg`;
    copperSpan.textContent = `$${copper.toFixed(2)}/lb â†’ â‚¹${copperInr.toFixed(0)}/kg`;
    crudeSpan.textContent = `$${crude.toFixed(2)}/bbl â†’ â‚¹${crudeInr.toFixed(2)}/L`;

    if(alertTarget && goldInr >= alertTarget){
      alert("ğŸ”” Gold crossed â‚¹"+goldInr.toFixed(2));
      alertTarget=null;
    }

  }catch(e){
    console.log("Error", e);
  }
}

function setAlert(){
  alertTarget = parseFloat(alertInput.value);
  alertStatus.innerHTML = "<small>Alert set at â‚¹"+alertTarget+"</small>";
}

const usdSpan = usd;
const goldSpan = gold;
const silverSpan = silver;
const copperSpan = copper;
const crudeSpan = crude;

refresh();
setInterval(refresh,60000);
</script>

</body>
</html>
