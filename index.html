<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Global Commodities Dashboard</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{background:#020617;color:#e5e7eb;font-family:system-ui;display:flex;justify-content:center;padding:20px}
.card{background:#0f172a;border:1px solid #1f2937;padding:20px;border-radius:16px;width:480px}
.row{display:flex;justify-content:space-between;padding:6px 0;cursor:pointer}
.row:hover{background:#020617}
input,button{background:#020617;border:1px solid #1f2937;color:#fff;padding:6px;border-radius:8px}
small{color:#94a3b8}
canvas{margin-top:10px}
</style>
</head>
<body>

<div class="card">
<h2>ğŸŒ Global Market Dashboard</h2>

<div class="row" onclick="loadChart('USDINR=X')">ğŸ’µ USD â†’ INR <span id="usdInr">...</span></div>
<div class="row" onclick="loadChart('XAUUSD=X')">ğŸŸ¨ Gold (â‚¹/g) <span id="gold">...</span></div>
<div class="row" onclick="loadChart('XAGUSD=X')">ğŸª™ Silver (â‚¹/kg) <span id="silver">...</span></div>
<div class="row" onclick="loadChart('HG=F')">ğŸŸ« Copper (â‚¹/kg) <span id="copper">...</span></div>
<div class="row" onclick="loadChart('CL=F')">ğŸ›¢ Crude Oil (â‚¹/L) <span id="crude">...</span></div>

<hr style="border-color:#1f2937">

<input id="alertPrice" placeholder="Gold alert â‚¹/gram">
<button onclick="setAlert()">ğŸ”” Set Gold Alert</button>
<div id="alertStatus"><small>No alert set</small></div>

<canvas id="chart" height="140"></canvas>

<p><small>Click any asset to view chart â€¢ Auto refresh every 60s</small></p>
</div>

<script>
const symbols={
 usd:"USDINR=X",
 gold:"XAUUSD=X",
 silver:"XAGUSD=X",
 copper:"HG=F",
 crude:"CL=F"
};

let prices={},alertTarget=null;

async function fetchPrice(sym){
 const url=`https://query1.finance.yahoo.com/v8/finance/chart/${sym}?interval=1m&range=1d`;
 const j=await (await fetch(url)).json();
 return j.chart.result[0].meta.regularMarketPrice;
}

async function refresh(){
 try{
  let usd=await fetchPrice(symbols.usd);
  let gold=await fetchPrice(symbols.gold);
  let silver=await fetchPrice(symbols.silver);
  let copper=await fetchPrice(symbols.copper);
  let crude=await fetchPrice(symbols.crude);

  let goldInr=(gold*usd)/31.1035;
  let silverInr=(silver*usd)*32.1507;
  let copperInr=(copper*usd)*2.20462;
  let crudeInr=(crude*usd)/159;

  usdInr.textContent=`â‚¹${usd.toFixed(2)}`;
  gold.textContent=`â‚¹${goldInr.toFixed(2)}`;
  silver.textContent=`â‚¹${silverInr.toFixed(0)}`;
  copper.textContent=`â‚¹${copperInr.toFixed(0)}`;
  crude.textContent=`â‚¹${crudeInr.toFixed(2)}`;

  if(alertTarget && goldInr>=alertTarget){
    alert("ğŸ”” Gold Alert Hit â‚¹"+goldInr.toFixed(2));
    alertTarget=null;
  }

 }catch(e){
  document.body.innerHTML="<h2 style='color:red'>API blocked temporarily. Refresh page.</h2>";
 }
}

function setAlert(){
 alertTarget=parseFloat(alertPrice.value);
 alertStatus.innerHTML="<small>Alert set at â‚¹"+alertTarget+"</small>";
}

let chart=new Chart(chartCtx,{
 type:"line",
 data:{labels:[],datasets:[{data:[],borderWidth:2}]},
 options:{responsive:true,plugins:{legend:{display:false}}}
});

async function loadChart(sym){
 const url=`https://query1.finance.yahoo.com/v8/finance/chart/${sym}?interval=5m&range=1d`;
 const j=await (await fetch(url)).json();
 let t=j.chart.result[0].timestamp;
 let p=j.chart.result[0].indicators.quote[0].close;
 chart.data.labels=t.map(x=>new Date(x*1000).toLocaleTimeString());
 chart.data.datasets[0].data=p;
 chart.update();
}

const chartCtx=document.getElementById("chart");

refresh();
setInterval(refresh,60000);
</script>

</body>
</html>
